<?php
class Affiliates_Totals_WordPress extends Affiliates_Totals { const IXAP174 = 'totals-nonce'; const IXAP175 = 'totals-nonce-1'; const IXAP176 = 'totals-nonce-2'; const IXAP263 = 'set-filters'; const IXAP264 = 'set-rpp'; const IXAP265 = 'set-page'; const IXAP266 = 'totals-nonce-mp'; const IXAP267 = 'gen-mp-pp'; const IXAP268 = 10; public static function view() { global $wpdb, $wp_rewrite, $affiliates_options; global $affiliates_db; $IXAP58 = ''; $IXAP97 = date( 'Y-m-d', time() ); if ( !current_user_can( AFFILIATES_ACCESS_AFFILIATES ) ) { wp_die( __( 'Access denied.', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); } if ( isset( $_POST['action'] ) ) { switch( $_POST['action'] ) { case 'do_foo' : break; } } else if ( isset ( $_GET['action'] ) ) { switch( $_GET['action'] ) { case 'close_referrals' : $IXAP30 = array( 'tables' => array( 'referrals' => $affiliates_db->get_tablename( 'referrals' ), 'affiliates' => $affiliates_db->get_tablename( 'affiliates' ), 'affiliates_users' => $affiliates_db->get_tablename( 'affiliates_users' ), 'users' => $wpdb->users, ) ); $IXAP30 = array_merge( $_GET, $IXAP30 ); echo self::update_status( AFFILIATES_REFERRAL_STATUS_CLOSED, $IXAP30 ); die(); break; } } if ( isset( $_POST['from_date'] ) || isset( $_POST['thru_date'] ) || isset( $_POST['minimum_total'] ) || isset( $_POST['referral_status'] ) || isset( $_POST['currency_id'] ) || isset( $_POST['clear_filters'] ) || isset( $_POST['affiliate_id'] ) || isset( $_POST['affiliate_name'] ) || isset( $_POST['affiliate_user_login'] ) || isset( $_POST['show_deleted'] ) || isset( $_POST['show_inoperative'] ) ) { if ( !wp_verify_nonce( $_POST[self::IXAP174], self::IXAP263 ) ) { wp_die( __( 'Access denied.', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); } } $IXAP31 = $affiliates_options->get_option( 'totals_from_date', null ); $IXAP32 = null; $IXAP33 = $affiliates_options->get_option( 'totals_thru_date', null ); $IXAP34 = null; $IXAP35 = $affiliates_options->get_option( 'totals_minimum_total', null ); $IXAP36 = $affiliates_options->get_option( 'totals_referral_status', null ); $IXAP37 = $affiliates_options->get_option( 'totals_currency_id', null ); $IXAP38 = $affiliates_options->get_option( 'totals_affiliate_id', null ); $IXAP39 = $affiliates_options->get_option( 'totals_affiliate_name', null ); $IXAP40 = $affiliates_options->get_option( 'totals_affiliate_user_login', null ); $IXAP269 = $affiliates_options->get_option( 'totals_show_deleted', false ); $IXAP270 = $affiliates_options->get_option( 'totals_show_inoperative', false ); if ( isset( $_POST['clear_filters'] ) ) { $affiliates_options->delete_option( 'totals_from_date' ); $affiliates_options->delete_option( 'totals_thru_date' ); $affiliates_options->delete_option( 'totals_minimum_total' ); $affiliates_options->delete_option( 'totals_referral_status' ); $affiliates_options->delete_option( 'totals_currency_id' ); $affiliates_options->delete_option( 'totals_affiliate_id' ); $affiliates_options->delete_option( 'totals_affiliate_name' ); $affiliates_options->delete_option( 'totals_affiliate_user_login' ); $affiliates_options->delete_option( 'totals_show_deleted' ); $affiliates_options->delete_option( 'totals_show_inoperative' ); $IXAP31 = null; $IXAP32 = null; $IXAP33 = null; $IXAP34 = null; $IXAP35 = null; $IXAP36 = null; $IXAP37 = null; $IXAP38 = null; $IXAP39 = null; $IXAP40 = null; $IXAP269 = false; $IXAP270 = false; } else if ( isset( $_POST['submitted'] ) ) { if ( !empty( $_POST['minimum_total'] ) ) { $IXAP35 = bcadd( "0", $_POST['minimum_total'], AFFILIATES_REFERRAL_AMOUNT_DECIMALS ); $affiliates_options->update_option( 'totals_minimum_total', $IXAP35 ); } else { $IXAP35 = null; $affiliates_options->delete_option( 'totals_minimum_total' ); } if ( !empty( $_POST['referral_status'] ) && ( $IXAP36 = Affiliates_Utility::verify_referral_status_transition( $_POST['referral_status'], $_POST['referral_status'] ) ) ) { $affiliates_options->update_option( 'totals_referral_status', $IXAP36 ); } else { $IXAP36 = null; $affiliates_options->delete_option( 'totals_referral_status' ); } if ( !empty( $_POST['currency_id'] ) && ( $IXAP37 = Affiliates_Utility::verify_currency_id( $_POST['currency_id'] ) ) ) { $affiliates_options->update_option( 'totals_currency_id', $IXAP37 ); } else { $IXAP37 = null; $affiliates_options->delete_option( 'totals_currency_id' ); } if ( !empty( $_POST['affiliate_name'] ) ) { $IXAP39 = $_POST['affiliate_name']; $affiliates_options->update_option( 'totals_affiliate_name', $IXAP39 ); } else { $IXAP39 = null; $affiliates_options->delete_option( 'totals_affiliate_name' ); } if ( !empty( $_POST['affiliate_user_login'] ) ) { $IXAP40 = $_POST['affiliate_user_login']; $affiliates_options->update_option( 'totals_affiliate_user_login', $IXAP40 ); } else { $IXAP40 = null; $affiliates_options->delete_option( 'totals_affiliate_user_login' ); } $IXAP269 = isset( $_POST['show_deleted'] ); $affiliates_options->update_option( 'totals_show_deleted', $IXAP269 ); $IXAP270 = isset( $_POST['show_inoperative'] ); $affiliates_options->update_option( 'totals_show_inoperative', $IXAP270 ); if ( !empty( $_POST['from_date'] ) ) { $IXAP31 = date( 'Y-m-d', strtotime( $_POST['from_date'] ) ); $affiliates_options->update_option( 'totals_from_date', $IXAP31 ); } else { $IXAP31 = null; $affiliates_options->delete_option( 'totals_from_date' ); } if ( !empty( $_POST['thru_date'] ) ) { $IXAP33 = date( 'Y-m-d', strtotime( $_POST['thru_date'] ) ); $affiliates_options->update_option( 'totals_thru_date', $IXAP33 ); } else { $IXAP33 = null; $affiliates_options->delete_option( 'totals_thru_date' ); } if ( $IXAP31 && $IXAP33 ) { if ( strtotime( $IXAP31 ) > strtotime( $IXAP33 ) ) { $IXAP33 = null; $affiliates_options->delete_option( 'totals_thru_date' ); } } if ( !empty( $_POST['affiliate_id'] ) ) { $IXAP38 = affiliates_check_affiliate_id( $_POST['affiliate_id'] ); if ( $IXAP38 ) { $affiliates_options->update_option( 'totals_affiliate_id', $IXAP38 ); } } else if ( isset( $_POST['affiliate_id'] ) ) { $IXAP38 = null; $affiliates_options->delete_option( 'totals_affiliate_id' ); } } if ( isset( $_POST['row_count'] ) ) { if ( !wp_verify_nonce( $_POST[self::IXAP175], self::IXAP264 ) ) { wp_die( __( 'Access denied.', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); } } if ( isset( $_POST['paged'] ) ) { if ( !wp_verify_nonce( $_POST[self::IXAP176], self::IXAP265 ) ) { wp_die( __( 'Access denied.', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); } } $IXAP66 = ( is_ssl() ? 'https://' : 'http://' ) . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']; $IXAP66 = remove_query_arg( 'paged', $IXAP66 ); $IXAP66 = remove_query_arg( 'action', $IXAP66 ); $IXAP66 = remove_query_arg( 'affiliate_id', $IXAP66 ); $IXAP45 = $affiliates_db->get_tablename( 'referrals' ); $IXAP43 = $affiliates_db->get_tablename( 'affiliates' ); $IXAP44 = $affiliates_db->get_tablename( 'affiliates_users' ); $IXAP58 .= '<div class="totals">' . '<div>' . '<h2>' . __( 'Totals', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</h2>' . '</div>'; $IXAP178 = isset( $_POST['row_count'] ) ? intval( $_POST['row_count'] ) : 0; if ($IXAP178 <= 0) { $IXAP178 = $affiliates_options->get_option( 'totals_per_page', self::IXAP268 ); } else { $affiliates_options->update_option('totals_per_page', $IXAP178 ); } $IXAP180 = isset( $_GET['offset'] ) ? intval( $_GET['offset'] ) : 0; if ( $IXAP180 < 0 ) { $IXAP180 = 0; } $IXAP181 = isset( $_GET['paged'] ) ? intval( $_GET['paged'] ) : 0; if ( $IXAP181 < 0 ) { $IXAP181 = 0; } $IXAP41 = isset( $_GET['orderby'] ) ? $_GET['orderby'] : null; switch ( $IXAP41 ) { case 'affiliate_id' : case 'name' : case 'user_login' : case 'email' : case 'total' : case 'currency_id' : break; default: $IXAP41 = 'name'; } $IXAP42 = isset( $_GET['order'] ) ? $_GET['order'] : null; switch ( $IXAP42 ) { case 'asc' : case 'ASC' : $IXAP182 = 'DESC'; break; case 'desc' : case 'DESC' : $IXAP182 = 'ASC'; break; default: $IXAP42 = 'ASC'; $IXAP182 = 'DESC'; } $IXAP47 = array( " 1=%d " ); $IXAP48 = array( 1 ); if ( $IXAP38 ) { $IXAP47[] = " a.affiliate_id = %d "; $IXAP48[] = $IXAP38; } if ( $IXAP39 ) { $IXAP47[] = " a.name LIKE '%%%s%%' "; $IXAP48[] = $IXAP39; } if ( $IXAP40 ) { $IXAP47[] = " u.user_login LIKE '%%%s%%' "; $IXAP48[] = $IXAP40; } if ( $IXAP31 ) { $IXAP32 = DateHelper::u2s( $IXAP31 ); } if ( $IXAP33 ) { $IXAP34 = DateHelper::u2s( $IXAP33, 24*3600 ); } if ( $IXAP32 && $IXAP34 ) { $IXAP47[] = " r.datetime >= %s AND r.datetime < %s "; $IXAP48[] = $IXAP32; $IXAP48[] = $IXAP34; } else if ( $IXAP32 ) { $IXAP47[] = " r.datetime >= %s "; $IXAP48[] = $IXAP32; } else if ( $IXAP34 ) { $IXAP47[] = " r.datetime < %s "; $IXAP48[] = $IXAP34; } if ( $IXAP36 ) { $IXAP47[] = " r.status = %s "; $IXAP48[] = $IXAP36; } if ( $IXAP37 ) { $IXAP47[] = " r.currency_id = %s "; $IXAP48[] = $IXAP37; } if ( !empty( $IXAP47 ) ) { $IXAP47 = " WHERE " . implode( " AND ", $IXAP47 ); } else { $IXAP47 = ''; } $IXAP49 = ''; if ( $IXAP35 ) { $IXAP49 .= " HAVING SUM(r.amount) >= %s "; $IXAP48[] = $IXAP35; } $IXAP189 = $affiliates_db->get_value( "
			SELECT COUNT(*) FROM (
			SELECT r.affiliate_id
			FROM $IXAP45 r
			LEFT JOIN $IXAP43 a ON r.affiliate_id = a.affiliate_id
			LEFT JOIN $IXAP44 au ON a.affiliate_id = au.affiliate_id
			LEFT JOIN $wpdb->users u on au.user_id = u.ID
			$IXAP47 
			GROUP BY r.affiliate_id, r.currency_id
			$IXAP49
			) tmp
			", $IXAP48 ); if ( $IXAP189 > $IXAP178 ) { $IXAP190 = true; } else { $IXAP190 = false; } $IXAP18 = ceil ( $IXAP189 / $IXAP178 ); if ( $IXAP181 > $IXAP18 ) { $IXAP181 = $IXAP18; } if ( $IXAP181 != 0 ) { $IXAP180 = ( $IXAP181 - 1 ) * $IXAP178; } $IXAP51 = $affiliates_db->get_objects( "
			SELECT a.*, u.user_login, SUM(r.amount) as total, r.currency_id
			FROM $IXAP45 r
			LEFT JOIN $IXAP43 a ON r.affiliate_id = a.affiliate_id
			LEFT JOIN $IXAP44 au ON a.affiliate_id = au.affiliate_id
			LEFT JOIN $wpdb->users u on au.user_id = u.ID
			$IXAP47
			GROUP BY r.affiliate_id, r.currency_id
			$IXAP49
			ORDER BY $IXAP41 $IXAP42 LIMIT $IXAP178 OFFSET $IXAP180
			", $IXAP48 ); $IXAP72 = array( 'affiliate_id' => __( 'Id', AFFILIATES_PRO_PLUGIN_DOMAIN ), 'name' => __( 'Affiliate', AFFILIATES_PRO_PLUGIN_DOMAIN ), 'email' => __( 'Email', AFFILIATES_PRO_PLUGIN_DOMAIN ), 'user_login' => __( 'Username', AFFILIATES_PRO_PLUGIN_DOMAIN ), 'total' => __( 'Total', AFFILIATES_PRO_PLUGIN_DOMAIN ), 'currency_id' => __( 'Currency', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); $IXAP58 .= '<div class="totals-overview">'; $IXAP64 = ""; if ( !empty( $IXAP31 ) ) { $IXAP64 .= "&from_date=" . urlencode( $IXAP31 ); } if ( !empty( $IXAP33 ) ) { $IXAP64 .= "&thru_date=" . urlencode( $IXAP33 ); } if ( !empty( $IXAP35 ) ) { $IXAP64 .= "&minimum_total=" . urlencode( $IXAP35 ); } if ( !empty( $IXAP36 ) ) { $IXAP64 .= "&referral_status=" . urlencode( $IXAP36 ); } if ( !empty( $IXAP37 ) ) { $IXAP64 .= "&currency_id=" . urlencode( $IXAP37 ); } if ( !empty( $IXAP38 ) ) { $IXAP64 .= "&affiliate_id=" . urlencode( $IXAP38 ); } if ( !empty( $IXAP39 ) ) { $IXAP64 .= "&affiliate_name=" . urlencode( $IXAP39 ); } if ( !empty( $IXAP40 ) ) { $IXAP64 .= "&affiliate_user_login=" . urlencode( $IXAP40 ); } if ( !empty( $IXAP41 ) ) { $IXAP64 .= "&orderby=" . urlencode( $IXAP41 ); } if ( !empty( $IXAP42 ) ) { $IXAP64 .= "&order=" . urlencode( $IXAP42 ); } $IXAP65 = esc_url( AFFILIATES_PRO_PLUGIN_URL . 'lib/ext/includes/generate-mass-payment-file.php' ); $IXAP58 .= '<div class="manage">'; $IXAP58 .= "<p>"; $IXAP58 .= "<a target='_blank' title='" . __( 'Export to File', AFFILIATES_PRO_PLUGIN_DOMAIN ) . "' " . "class='button generate export' " . "href='" . $IXAP65 . "?action=generate_mass_payment_file&service=export" . $IXAP64 . "'>" . "<img class='icon' alt='" . __( 'Generate', AFFILIATES_PRO_PLUGIN_DOMAIN) . "' src='". AFFILIATES_PRO_PLUGIN_URL ."images/export.png'/>" . "<span class='label'>" . __( 'Export', AFFILIATES_PRO_PLUGIN_DOMAIN) . "</span>" . "</a>"; $IXAP58 .= "<a target='_blank' title='" . __( 'Generate a Mass Payment File', AFFILIATES_PRO_PLUGIN_DOMAIN ) . "' " . "class='button generate paypal' " . "href='" . $IXAP65 . "?action=generate_mass_payment_file&service=paypal" . $IXAP64 . "'>" . "<img class='icon' alt='" . __( 'Generate', AFFILIATES_PRO_PLUGIN_DOMAIN) . "' src='". AFFILIATES_PRO_PLUGIN_URL ."images/export.png'/>" . "<span class='label'>" . __( 'Mass Payment File', AFFILIATES_PRO_PLUGIN_DOMAIN) . "</span>" . "</a>"; $IXAP58 .= "<a title='" . __( 'Click to close these referrals', AFFILIATES_PRO_PLUGIN_DOMAIN ) . "' " . "class='button close-referrals' " . "href='" . esc_url( $IXAP66 ) . "&action=close_referrals" . $IXAP64 . "'>" . "<img class='icon' alt='" . __( 'Close referrals', AFFILIATES_PRO_PLUGIN_DOMAIN) . "' src='". AFFILIATES_PRO_PLUGIN_URL ."images/closed.png'/>" . "<span class='label'>" . __( 'Close Referrals', AFFILIATES_PRO_PLUGIN_DOMAIN) . "</span>" . "</a>"; $IXAP58 .= "</p>"; $IXAP58 .= '<ul>'; $IXAP58 .= '<li>'; $IXAP58 .= __( '<strong>Export</strong> : Export the current totals listing to a file.', AFFILIATES_PRO_PLUGIN_DOMAIN ); $IXAP58 .= '</li>'; $IXAP58 .= '<li>'; $IXAP58 .= __( '<strong>Mass Payment File</strong> : Export the current totals for mass payment compatible with the PayPal file format<sup>*</sup>.', AFFILIATES_PRO_PLUGIN_DOMAIN ); $IXAP58 .= '</li>'; $IXAP58 .= '<li>'; $IXAP58 .= '</ul>'; $IXAP58 .= '<p style="font-size:0.92em">'; $IXAP58 .= sprintf( __( "<sup>*</sup>Note that the PayPal Mass Payment <a target='_blank' href='%s'>File Format</a> allows only one currency type per Mass Payment file.", AFFILIATES_PRO_PLUGIN_DOMAIN ), "https://www.paypal.com/cgi-bin/webscr?cmd=_batch-payment-format-outside" ); $IXAP58 .= ' '; $IXAP58 .= __( 'Use the <em>Currency</em> filter to restrict the listing to one currency.', AFFILIATES_PRO_PLUGIN_DOMAIN ); $IXAP58 .= ' '; $IXAP58 .= __( 'Where a specific PayPal email address is on file for an affiliate, it will be used.', AFFILIATES_PRO_PLUGIN_DOMAIN ); $IXAP58 .= '</p>'; $IXAP58 .= '</div>'; $IXAP71 = array( AFFILIATES_REFERRAL_STATUS_ACCEPTED => __( 'Accepted', AFFILIATES_PLUGIN_DOMAIN ), AFFILIATES_REFERRAL_STATUS_CLOSED => __( 'Closed', AFFILIATES_PLUGIN_DOMAIN ), AFFILIATES_REFERRAL_STATUS_PENDING => __( 'Pending', AFFILIATES_PLUGIN_DOMAIN ), AFFILIATES_REFERRAL_STATUS_REJECTED => __( 'Rejected', AFFILIATES_PLUGIN_DOMAIN ), ); $IXAP271 = '<label class="referral-status-filter" for="referral_status">' . __('Referral Status', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>'; $IXAP271 .= '<select class="referral-status-filter" name="referral_status">'; $IXAP271 .= '<option value="" ' . ( empty( $IXAP36 ) ? ' selected="selected" ' : '' ) . '>--</option>'; foreach ( $IXAP71 as $IXAP74 => $IXAP129 ) { $IXAP272 = $IXAP74 == $IXAP36 ? ' selected="selected" ' : ''; $IXAP271 .= '<option ' . $IXAP272 . ' value="' . esc_attr( $IXAP74 ) . '">' . $IXAP129 . '</option>'; } $IXAP271 .= '</select>'; $IXAP273 = $affiliates_db->get_objects( "SELECT DISTINCT(currency_id) FROM $IXAP45 WHERE currency_id IS NOT NULL" ); $IXAP274 = '<label class="currency-id-filter" for="currency_id">' . __( 'Currency', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>'; $IXAP274 .= '<select class="currency-id-filter" name="currency_id">'; $IXAP274 .= '<option value="" ' . ( empty( $IXAP37 ) ? ' selected="selected" ' : '' ) . '>--</option>'; foreach ( $IXAP273 as $IXAP275 ) { $IXAP272 = $IXAP275->currency_id == $IXAP37 ? ' selected="selected" ' : ''; $IXAP274 .= '<option ' . $IXAP272 . ' value="' . esc_attr( $IXAP275->currency_id ) . '">' . $IXAP275->currency_id . '</option>'; } $IXAP274 .= '</select>'; $IXAP58 .= '<div class="filters">' . '<label class="description" for="setfilters">' . __( 'Filters', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<form id="setfilters" action="" method="post">' . '<p>' . $IXAP271 . '<label class="minimum-total-filter" for="minimum_total">' . __( 'Minimum Total', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="minimum-total-filter" name="minimum_total" type="text" value="' . esc_attr( $IXAP35 ) . '"/>' . $IXAP274 . '</p>' . '<p>' . '<label class="affiliate-id-filter" for="affiliate_id">' . __( 'Affiliate Id', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="affiliate-id-filter" name="affiliate_id" type="text" value="' . esc_attr( $IXAP38 ) . '"/>' . '<label class="affiliate-name-filter" for="affiliate_name">' . __( 'Affiliate Name', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="affiliate-name-filter" name="affiliate_name" type="text" value="' . $IXAP39 . '"/>' . '<label class="affiliate-user-login-filter" for="affiliate_user_login">' . __( 'Affiliate Username', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="affiliate-user-login-filter" name="affiliate_user_login" type="text" value="' . $IXAP40 . '" />' . '</p>' . '<p>' . '<label class="from-date-filter" for="from_date">' . __( 'From', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="datefield from-date-filter" name="from_date" type="text" value="' . esc_attr( $IXAP31 ) . '"/>'. '<label class="thru-date-filter" for="thru_date">' . __( 'Until', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input class="datefield thru-date-filter" name="thru_date" type="text" class="datefield" value="' . esc_attr( $IXAP33 ) . '"/>'. '</p>
					<p>' . wp_nonce_field( self::IXAP263, self::IXAP174, true, false ) . '<input class="button" type="submit" value="' . __( 'Apply', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '"/>' . '<input class="button" type="submit" name="clear_filters" value="' . __( 'Clear', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '"/>' . '<input type="hidden" value="submitted" name="submitted"/>' . '</p>' . '</form>' . '</div>'; $IXAP58 .= '
			<div class="page-options">
				<form id="setrowcount" action="" method="post">
					<div>
						<label for="row_count">' . __('Results per page', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</label>' . '<input name="row_count" type="text" size="2" value="' . esc_attr( $IXAP178 ) .'" />
						' . wp_nonce_field( self::IXAP264, self::IXAP175, true, false ) . '
						<input class="button" type="submit" value="' . __( 'Apply', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '"/>
					</div>
				</form>
			</div>
			'; if ( $IXAP190 ) { $IXAP191 = new Affiliates_Pagination( $IXAP189, null, $IXAP178 ); $IXAP58 .= '<form id="posts-filter" method="post" action="">'; $IXAP58 .= '<div>'; $IXAP58 .= wp_nonce_field( self::IXAP265, self::IXAP176, true, false ); $IXAP58 .= '</div>'; $IXAP58 .= '<div class="tablenav top">'; $IXAP58 .= $IXAP191->pagination( 'top' ); $IXAP58 .= '</div>'; $IXAP58 .= '</form>'; } $IXAP58 .= '
			<table class="wp-list-table widefat fixed" cellspacing="0">
			<thead>
				<tr>
				'; foreach ( $IXAP72 as $IXAP74 => $IXAP75 ) { $IXAP101 = array( 'orderby' => $IXAP74, 'order' => $IXAP182 ); $IXAP139 = $IXAP74; if ( !in_array($IXAP74, array( 'edit', 'remove', 'links' ) ) ) { if ( strcmp( $IXAP74, $IXAP41 ) == 0 ) { $IXAP198 = strtolower( $IXAP42 ); $IXAP139 = "$IXAP74 manage-column sorted $IXAP198"; } else { $IXAP139 = "$IXAP74 manage-column sortable"; } $IXAP75 = '<a href="' . esc_url( add_query_arg( $IXAP101, $IXAP66 ) ) . '"><span>' . $IXAP75 . '</span><span class="sorting-indicator"></span></a>'; } $IXAP58 .= "<th scope='col' class='$IXAP139'>$IXAP75</th>"; } $IXAP58 .= '</tr>
			</thead>
			<tbody>
			'; if ( count( $IXAP51 ) > 0 ) { for ( $IXAP76 = 0; $IXAP76 < count( $IXAP51 ); $IXAP76++ ) { $IXAP15 = $IXAP51[$IXAP76]; $name_suffix = ''; $IXAP276 = ''; if ( $IXAP277 = ( strcmp( $IXAP15->status, 'deleted' ) == 0 ) ) { $IXAP276 = ' deleted '; $name_suffix .= " " . __( '(removed)', AFFILIATES_PRO_PLUGIN_DOMAIN ); } $IXAP278 = ''; if ( $IXAP279 = ! ( ( $IXAP15->from_date <= $IXAP97 ) && ( $IXAP15->thru_date == null || $IXAP15->thru_date >= $IXAP97 ) ) ) { $IXAP278 = ' inoperative '; $name_suffix .= " " . __( '(inoperative)', AFFILIATES_PRO_PLUGIN_DOMAIN ); } $IXAP58 .= '<tr class="' . $IXAP276 . $IXAP278 . ( $IXAP76 % 2 == 0 ? 'even' : 'odd' ) . '">'; $IXAP58 .= "<td class='affiliate-id'>"; if ( affiliates_encode_affiliate_id( $IXAP15->affiliate_id ) != $IXAP15->affiliate_id ) { $IXAP58 .= '<span class="encoded-hint" title="' . affiliates_encode_affiliate_id( $IXAP15->affiliate_id ) . '">' . $IXAP15->affiliate_id . '</span>'; } else { $IXAP58 .= $IXAP15->affiliate_id; } $IXAP58 .= "</td>"; $IXAP58 .= "<td class='affiliate-name'>" . stripslashes( wp_filter_nohtml_kses( $IXAP15->name ) ) . $name_suffix . "</td>"; $IXAP58 .= "<td class='affiliate-email'>" . $IXAP15->email . "</td>"; $IXAP58 .= "<td class='affiliate-user-login'>" . $IXAP15->user_login . "</td>"; $IXAP58 .= "<td class='total'>$IXAP15->total</td>"; $IXAP58 .= "<td class='currency-id'>$IXAP15->currency_id</td>"; $IXAP58 .= '</tr>'; } } else { $IXAP58 .= '<tr><td colspan="' . count( $IXAP72 ) . '">' . __( 'There are no results.', AFFILIATES_PRO_PLUGIN_DOMAIN ) . '</td></tr>'; } $IXAP58 .= '</tbody>'; $IXAP58 .= '</table>'; if ( $IXAP190 ) { $IXAP191 = new Affiliates_Pagination($IXAP189, null, $IXAP178); $IXAP58 .= '<div class="tablenav bottom">'; $IXAP58 .= $IXAP191->pagination( 'bottom' ); $IXAP58 .= '</div>'; } $IXAP58 .= '</div>'; $IXAP58 .= '</div>'; echo $IXAP58; affiliates_footer(); } } 